Office.initialize = function (reason) { document.addEventListener('DOMContentLoaded', function () { console.log("Add-in initialized"); // Attach event handler to all links in the email message body document.querySelectorAll('a').forEach(function (link) { link.addEventListener('click', function (event) { var clickedLink = link.href; // Check if the clicked link contains abb.com' if (!clickedLink.includes(abb.com')) { event.preventDefault(); // Stop the default link opening behavior // Show a confirmation popup with the actual link var userChoice = confirm(`You are about to visit: ${clickedLink}\n\nDo you want to proceed?`); if (userChoice) { // If the user confirms, open the link window.open(clickedLink, '_blank'); } else { alert('You chose not to visit the link.'); } } }); }); }); };
